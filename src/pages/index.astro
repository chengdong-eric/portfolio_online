---
// src/pages/index.astro

import Layout from '../layouts/layout.astro';
import Icon from '../components/icon.astro';
import { marked } from 'marked';

// --- MOCK PROJECT DATA (Remains the same) ---
const projects = [
  {
    title: "EcoTrack Analytics",
    shortDescription: "A data visualization platform for environmental scientists.",
    longDescription: `
EcoTrack Analytics was built to help researchers track and visualize climate data in real-time. Key features include:

-   **Interactive Maps:** Built with Leaflet.js to show changing weather patterns.
-   **User-friendly Dashboard:** Developed with React and styled-components for a seamless user experience.
-   **Robust Backend:** Powered by Node.js and Express, handling data streams from multiple public APIs.
    `,
    githubLink: "#",
    imageSrc: "https://images.unsplash.com/photo-1579621970795-87f54f597340?q=80&w=2070&auto=format&fit=crop",
    imageAlt: "A screen showing green and blue financial graphs"
  },
  {
    title: "Project Nova",
    shortDescription: "A slick and modern landing page for a fictional SaaS company.",
    longDescription: `
Project Nova is a fully responsive, mobile-first landing page designed to maximize user engagement and conversion. The tech stack focuses on performance and clean code.

-   Built entirely with **Astro** for incredible speed.
-   Styled using **Tailwind CSS** for rapid UI development.
-   Animations powered by the **Intersection Observer API** for smooth, performant scroll effects.
    `,
    githubLink: "#",
    imageSrc: "https://images.unsplash.com/photo-1551288049-bebda4e38f71?q=80&w=2070&auto=format&fit=crop",
    imageAlt: "A laptop showing various colorful data charts and graphs"
  }
];
---

<Layout title="Cheng Dong - Portfolio">
  <main>
    <!-- HERO/WELCOME SECTION (MODIFIED) -->
    <!-- 1. Shortened hero section by changing 80vh to 55vh -->
    <section class="container" style="min-height: 55vh; display: grid; place-content: center; text-align: center;">
      <div>
        <h2>Welcome!</h2>
        <!-- 2. Added "Bienvenue!" below Welcome -->
        <p style="font-size: var(--type-scale-h4);">Bienvenue!</p>
      </div>
    </section>

    <!-- WORK SECTION (MODIFIED) -->
    <section id="work" class="work-section container">
      <h2 class="work-section__title">My Work</h2>
      <div class="work-section__projects">
        {projects.map(project => (
          <article class="project-card">
            <div class="project-card__info">
              
              <!-- 3. NEW header to group title and icon -->
              <header class="project-card__header">
                <h3 class="project-card__title">{project.title}</h3>
                <div class="project-card__link">
                  <Icon name="github" href={project.githubLink} label="View on GitHub" size="2em" />
                </div>
              </header>

              <p class="project-card__short-desc">{project.shortDescription}</p>
              
              <div class="project-card__long-desc" set:html={marked.parse(project.longDescription)} />
              
              <!-- The GitHub icon link has been moved from here to the header -->

            </div>
            <div class="project-card__image-container">
              <img src={project.imageSrc} alt={project.imageAlt} class="project-card__image"/>
            </div>
          </article>
        ))}
      </div>
    </section>

    <!-- ABOUT SECTION (Remains the same) -->
    <section id="about" class="container" style="padding-block: var(--section-padding-block);">
      <h2>About Me</h2>
      <p>Here is some information about me.</p>
    </section>
  </main>
</Layout>

<style>
  /* --- WORK SECTION STYLES (MODIFIED) --- */
  .work-section {
    padding-block: var(--section-padding-block);
  }

  .work-section__title {
    text-align: center;
    margin-bottom: var(--gap);
  }

  .work-section__projects {
    display: grid;
    gap: var(--gap);
  }

  .project-card {
    background-color: var(--color-bg);
    border: 6px dashed var(--color-hover-green);
    border-radius: var(--border-radius);
    padding: var(--gap);
    display: flex;
    flex-direction: column;
    gap: var(--gap);
    overflow: hidden;
    
  }

  .project-card__info {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  /* 4. NEW rule for the header */
  .project-card__header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start; /* Aligns items to the top */
      gap: 1rem;
  }

  .project-card__title {
    font-size: var(--type-scale-h3);
    line-height: 1.1; /* Ensure tight line height */
  }

  /* 5. MODIFIED rule for the link container */
  .project-card__link {
    /* margin-top: auto; has been removed */
    /* padding-top: 1rem; has been removed */
    flex-shrink: 0; /* Prevents the icon from shrinking if the title is long */
    align-self: center;
  }

  .project-card__short-desc {
    font-size: var(--type-scale-h5);
    font-weight: 600;
    line-height: 1.3;
  }

  .project-card__long-desc {
    font-size: 1rem;
    line-height: 1.6;
  }
  
  .project-card__long-desc ul {
      list-style-position: inside;
      padding-left: 1rem;
  }
  
  .project-card__image-container {
    border-radius: calc(var(--border-radius) / 2);
    overflow: hidden;
  }

  .project-card__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition);
  }

  .project-card:hover .project-card__image {
      transform: scale(1.05);
  }

  /* --- DESKTOP LAYOUT (Remains the same) --- */
  @media (min-width: 768px) {
    .project-card {
      flex-direction: row;
      align-items: flex-start;
    }

    .project-card__info {
      flex: 2;
    }

    .project-card__image-container {
      flex: 1;
    }
  }
</style>